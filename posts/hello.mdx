---
title: "First Post"
date: "2021-08-24"
time_to_read: "3min"
author: Mohammad Afroz
# image: "url"
categories: ["Web"]
description: Setting up a blog using next.js with mdx capabilities.
---

This website has been developed using below Technolgies:

- **[Next.js](https://nextjs.org/docs)** (which is based on React,provides dynamic page routes, SSG, SSR, Font/Image/Script Optimizations and much more)
- **Typescript**
- **Styled Components** (CSS-in-JS library)
- **gray-matter** to extract frontMatter and content from mdx files and turn it into a big long string which then parsed by mdx loader.

  - `mdx-data-loader.js`

    ```js-ln
    const matter = require("gray-matter");
    const stringifyObject = require("stringify-object");

    module.exports = async function (src) {
      const callback = this.async();
      const { content, data } = matter(src);

      const code = `export const frontMatter = ${stringifyObject(data)}

    ${content}`;

      return callback(null, code);
    };
    ```

- **@mdx-js/loader** is Webpack loader for MDX.

  - `next.config.js`

    ```js
    module.exports = {
      // other config

      webpack: (config, { webpack, defaultLoaders }) => {
        config.resolve.alias["@"] = path.resolve(__dirname, ".");
        config.module.rules.push({
          test: /\.mdx?$/,
          use: [
            defaultLoaders.babel,
            "@mdx-js/loader",
            path.join(__dirname, "./lib/mdx-data-loader"),
          ],
        });
        return config;
      },
      // other config
    };
    ```

  - Now I can render MDX `article/[...id].js`

    ```js
    //  @mdx-js/loader,gray-matter let's me do this
    export default App =({resourceId}) => {

      const MDX = dynamic(() => import(`../../posts/${resourceId}.mdx`)

      return (<MDX />)
    }

    ```

- **babel-plugin-import-glob-array** babel plugin to enable importing modules using a glob pattern.It helped me to generate list of articles and their frontMatter details which then used in `getStaticProps` function for `ArticleList` component.

  - `mdx-util.js`

    ```js
    // above package combined with @mdx-js/loader,gray-matter let's me do this
    import {
      frontMatter as postFms,
      _importMeta as postMetadatas,
    } from "../posts/*.mdx";
    ```

- **next-offline** for offline caching capabilities.
- **prism-react-renderer** for code blocks.
- Followed this article on [How to setup DarkMode for Gatsby](https://www.joshwcomeau.com/react/dark-mode/) for dark mode setup.

  - The idea is injecting theme changing js code into html at build time.
  - Js code fetches preferred/persisted colorMode and applies styles accordingly.
  - Instead of adding css variables to html,we can also add css class to body which is more easier and neat.
  - `gatsby-ssr.js` is analogous to `_document.js`
  - full code: [\_document.tsx](https://github.com/zkindest/zkindest.github.io/blob/main/pages/_document.tsx)
